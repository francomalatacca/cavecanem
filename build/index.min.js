"use strict";function atob(a){return new Buffer(a,"base64").toString("binary")}var extractCredentialsFromHeader=function(a){var b=a.split(" "),c=null,d=null;if(!(b.length>0))throw new Error("Bad authentication format");return b=a.split(" ")[1],b=atob(b),c=b.split(":")[0],d=b.split(":")[1],{username:c,password:d}},checkAuthenticationString=function(a){return/Basic ([A-Za-z_\d]{18,22})+g/.test(a)},checkAuthorization=function(a,b,c,d){return d(a,b,c)},authentication=function(a,b,c){var d=a.header("authorization");if(d&&checkAuthenticationString(d))try{var e=extractCredentialsFromHeader(d);if(a.cc&&a.cc.acl);else{var f=a.cc.checkCredentials(e);if(f)return a.cc.credentials=e,c(a,b);b.send(401,{Description:"The username or password are wrong"})}}catch(g){b.send(401,{Description:"Error in authorization header"})}else b.send(401,{Description:"No authorization header is provided"});return c(a,b)},extractResourceNameFromURL=function(a){var b=a.split("/"),c=b[b.length-1];return c};module.exports=authentication;